# 同步数据（Synchronized data）

## 客户端拉取（pull）

### 本地没有数据

客户端首先拉取笔记数据的最新状态，然后拉取SubmitTree

### 本地有数据

客户端拉取SubmitTree，并递归SubmitTree，根据Operation重放操作，使得本地数据与服务端数据一致。

## 客户端推送（push）

### 服务端与本地一致

推送SubmitBlock

### 服务端与本地不一致

#### 冲突

服务端与本地不一致，并且产生冲突，则要求用户确认冲突，进行冲突合并。

#### 不冲突

推送SubmitBlock

## 快速模式

客户端直接调用note、notebook的API进行数据操作，服务端进行处理后返回操作结果。

在快速模式下，默认所有操作都是异步的，必须以mqtt over websocket协议接受消息确认操作是否完成。

客户端也可以通过http参数，强制服务端必须以同步模式处理，但是同步请求是受限的（并发数），并且要求必须是授权的。以同步模式调用将消耗更多服务器更多资源，并且无法感知同步。
